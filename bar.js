var Excel=require("exceljs"),_=require("underscore"),find=require("find"),pkgInfo=[],pkgJsonPath=[],argslist=[],corruptedCount=0;process.argv.forEach(function(d,e){argslist.push(d)});var __dirname=argslist[2],_SaveExcelPath=argslist[3];
find.file(/\\package.json$/,__dirname,function(d){_.each(d,function(e,a){d[a].toString();e=d[a].split("\\");var c="";_.each(e,function(a,b){c=c+a+"/"});c=c.slice(0,-1);pkgJsonPath[a]=c;try{var b=require(c);null!=b&&(a={},a.AuthorName=null!=(b.author&&b.author.name)?b.author.name:"",a.license=null!=b.license?b.license:"",a.Version=null!=b.version?b.version:"NotFound",a.homepage=null!=b.homepage?b.homepage:c,a.Componentname=null!=b.name?b.name:"",pkgInfo.push(a))}catch(f){corruptedCount++,console.log(f.message)}});
console.log("Total File Found is :  "+pkgJsonPath.length);console.log("No. Of file corrupt is :  "+(pkgJsonPath.length-pkgInfo.length));CreateWorkBook(pkgInfo)});
function CreateWorkBook(d){console.log("******************Start Writing to Excel****************");var e=new Excel.Workbook;e.creator="Anshul Rana";var a=e.addWorksheet("Reoprt1",{pageSetup:{paperSize:9,orientation:"landscape"}});a.columns=[{header:"Component  Name",key:"Componentname",width:30},{header:"license",key:"license",width:30},{header:"Version",key:"Version",width:30},{header:"Author Name",key:"AuthorName",width:30},{header:"Homepage",key:"homepage",width:70}];a.getRow(1).font={name:"Arial Black",
bold:!0};_.each(d,function(c,b){a.addRow({Componentname:c.Componentname,license:c.license,Version:c.Version,AuthorName:c.AuthorName,homepage:c.homepage});e.xlsx.writeFile(_SaveExcelPath).then(function(){})});console.log("No. of item added to Excel is : "+d.length);console.log("******************End Writing to Excel****************")};